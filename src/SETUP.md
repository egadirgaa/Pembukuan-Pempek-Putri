# Panduan Setup Aplikasi Pempek Putri

## Informasi Database Supabase

- **Project URL**: https://jyvjvixxdhonjhsnejmc.supabase.co
- **Project Ref**: jyvjvixxdhonjhsnejmc
- **Database Password**: silambat123A

## Langkah-Langkah Setup

### 1. Dapatkan Supabase Anon Key

1. Login ke [Supabase Dashboard](https://supabase.com/dashboard)
2. Pilih project Anda
3. Buka **Settings** → **API**
4. Copy **anon/public key** (formatnya seperti: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`)

### 2. Update Supabase Client

Buka file `/lib/supabaseClient.ts` dan ganti `supabaseAnonKey` dengan key yang Anda copy dari dashboard.

### 3. Setup Database Schema

Jalankan SQL berikut di **SQL Editor** Supabase Dashboard:

```sql
-- Tabel Produk
create table public.produk (
  id bigint generated by default as identity primary key,
  nama_produk text not null,
  harga_jual integer not null,
  stok integer default 0
);

-- Tabel Transaksi Penjualan
create table public.transaksi_penjualan (
  id bigint generated by default as identity primary key,
  tanggal timestamp with time zone default now(),
  produk_id bigint references public.produk(id) on delete set null,
  jumlah integer not null,
  harga_satuan integer not null,
  total integer generated always as (jumlah * harga_satuan) stored,
  metode_bayar text check (metode_bayar in ('Tunai', 'Non-Tunai', 'Piutang')),
  keterangan text
);

-- Tabel Pengeluaran
create table public.pengeluaran (
  id bigint generated by default as identity primary key,
  tanggal timestamp with time zone default now(),
  kategori text not null,
  deskripsi text,
  jumlah integer not null
);

-- Tabel Supplier
create table public.supplier (
  id bigint generated by default as identity primary key,
  nama text not null,
  kontak text,
  alamat text,
  bahan_dipasok text
);

-- Tabel Pembelian Bahan
create table public.pembelian_bahan (
  id bigint generated by default as identity primary key,
  tanggal timestamp with time zone default now(),
  supplier_id bigint references public.supplier(id) on delete set null,
  nama_bahan text not null,
  jumlah integer not null,
  harga_satuan integer not null,
  total integer generated always as (jumlah * harga_satuan) stored
);

-- Tabel Hutang
create table public.hutang (
  id bigint generated by default as identity primary key,
  nama_pihak text not null,
  jumlah integer not null,
  tanggal_pinjam date not null,
  tanggal_jatuh_tempo date,
  status text check (status in ('Belum Lunas', 'Lunas')) default 'Belum Lunas'
);

-- Tabel Piutang
create table public.piutang (
  id bigint generated by default as identity primary key,
  nama_pelanggan text not null,
  jumlah_piutang integer not null,
  tanggal_transaksi date not null,
  tanggal_jatuh_tempo date,
  status text check (status in ('Belum Bayar', 'Sudah Bayar')) default 'Belum Bayar'
);

-- Tabel Stok Bahan
create table public.stok_bahan (
  id bigint generated by default as identity primary key,
  nama_bahan text not null,
  jumlah integer not null,
  satuan text not null,
  tanggal_update timestamp with time zone default now()
);

-- Tabel Laporan (Opsional)
create table public.laporan (
  id bigint generated by default as identity primary key,
  periode text not null,
  total_pemasukan integer default 0,
  total_pengeluaran integer default 0,
  laba_bersih integer generated always as (total_pemasukan - total_pengeluaran) stored,
  catatan text
);
```

### 4. Setup Authentication (Opsional tapi Disarankan)

1. Buka **Authentication** → **Providers** di Supabase Dashboard
2. Enable **Email** provider
3. Atur email templates jika diperlukan
4. Untuk development, Anda bisa disable email confirmation di **Authentication** → **Settings** → disable "Enable email confirmations"

### 5. Setup Row Level Security (RLS) - SANGAT PENTING!

Untuk keamanan data multi-user, jalankan SQL berikut:

```sql
-- Enable RLS pada semua tabel
alter table public.produk enable row level security;
alter table public.transaksi_penjualan enable row level security;
alter table public.pengeluaran enable row level security;
alter table public.supplier enable row level security;
alter table public.pembelian_bahan enable row level security;
alter table public.hutang enable row level security;
alter table public.piutang enable row level security;
alter table public.stok_bahan enable row level security;
alter table public.laporan enable row level security;

-- Policy: Allow authenticated users to access all data
-- CATATAN: Ini adalah policy sederhana. Untuk production, 
-- sebaiknya buat policy yang lebih spesifik per user.

-- Produk
create policy "Allow authenticated users to manage produk"
  on public.produk
  for all
  to authenticated
  using (true)
  with check (true);

-- Transaksi Penjualan
create policy "Allow authenticated users to manage transaksi_penjualan"
  on public.transaksi_penjualan
  for all
  to authenticated
  using (true)
  with check (true);

-- Pengeluaran
create policy "Allow authenticated users to manage pengeluaran"
  on public.pengeluaran
  for all
  to authenticated
  using (true)
  with check (true);

-- Supplier
create policy "Allow authenticated users to manage supplier"
  on public.supplier
  for all
  to authenticated
  using (true)
  with check (true);

-- Pembelian Bahan
create policy "Allow authenticated users to manage pembelian_bahan"
  on public.pembelian_bahan
  for all
  to authenticated
  using (true)
  with check (true);

-- Hutang
create policy "Allow authenticated users to manage hutang"
  on public.hutang
  for all
  to authenticated
  using (true)
  with check (true);

-- Piutang
create policy "Allow authenticated users to manage piutang"
  on public.piutang
  for all
  to authenticated
  using (true)
  with check (true);

-- Stok Bahan
create policy "Allow authenticated users to manage stok_bahan"
  on public.stok_bahan
  for all
  to authenticated
  using (true)
  with check (true);

-- Laporan
create policy "Allow authenticated users to manage laporan"
  on public.laporan
  for all
  to authenticated
  using (true)
  with check (true);
```

### 6. Data Awal (Sample Data)

Setelah setup selesai, Anda bisa menambahkan data contoh melalui UI aplikasi:

**Produk:**
- Pempek Kapal Selam - Rp 15.000
- Pempek Lenjer - Rp 10.000
- Pempek Adaan - Rp 8.000
- Tekwan - Rp 12.000
- Model - Rp 15.000

**Stok Bahan:**
- Ikan Tenggiri - 50 kg
- Tepung Tapioka - 25 kg
- Minyak Goreng - 20 liter
- Telur - 100 butir
- Cuka - 5 liter

**Supplier:**
- Toko Bahan Makanan Jaya - 08123456789 - Ikan, Tepung
- Supplier Minyak Berkah - 08234567890 - Minyak Goreng
- Pasar Ikan Fresh - 08345678901 - Ikan

## Cara Menjalankan Aplikasi

1. Pastikan semua setup di atas sudah dilakukan
2. Register akun baru melalui halaman `/register`
3. Login dengan akun yang sudah dibuat
4. Mulai gunakan aplikasi!

## Troubleshooting

### Error: "Invalid API key"
- Pastikan Anda sudah mengganti `supabaseAnonKey` di `/lib/supabaseClient.ts` dengan key yang benar dari Supabase Dashboard

### Error: "Row Level Security policy violation"
- Pastikan Anda sudah menjalankan SQL untuk setup RLS policies
- Pastikan user sudah login (authenticated)

### Error saat register/login
- Pastikan Email provider sudah di-enable di Supabase Dashboard
- Untuk development, disable email confirmation di Authentication Settings

### Data tidak muncul di Dashboard
- Pastikan sudah ada data di database
- Cek console browser untuk error messages
- Pastikan RLS policies sudah disetup dengan benar

## Fitur Aplikasi

✅ **Dashboard** - Ringkasan keuangan harian
✅ **Penjualan** - Catat transaksi penjualan  
✅ **Produk** - Kelola produk pempek
✅ **Pengeluaran** - Catat pengeluaran operasional
✅ **Stok Bahan** - Pantau stok bahan baku
✅ **Pembelian Bahan** - Catat pembelian dari supplier
✅ **Supplier** - Kelola data supplier
✅ **Piutang** - Tracking pelanggan berutang
✅ **Hutang** - Tracking hutang usaha
✅ **Laporan Keuangan** - Laporan & analisis keuangan
✅ **Pengaturan** - Backup/restore & preferensi

## Support

Jika ada pertanyaan atau kendala, silakan hubungi developer atau buat issue di repository.
